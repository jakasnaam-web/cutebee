local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local MessageModule = {}

function MessageModule:ShowMessage(text, duration)
    duration = duration or 4

    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "SapiHubNotificationGui"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = playerGui

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 200, 0, 44)
    frame.Position = UDim2.new(1, 20, 1, -80)
    frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    frame.BackgroundTransparency = 0 
    frame.BorderSizePixel = 0
    frame.AnchorPoint = Vector2.new(0, 0)
    frame.ClipsDescendants = true
    frame.Parent = screenGui

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = frame

    local border = Instance.new("UIStroke")
    border.Thickness = 2
    border.Color = Color3.fromRGB(0, 170, 255)
    border.Transparency = 0 
    border.Parent = frame

    local shadow = Instance.new("ImageLabel")
    shadow.Name = "Shadow"
    shadow.AnchorPoint = Vector2.new(0.5, 0.5)
    shadow.Position = UDim2.new(0.5, 0, 0.5, 0)
    shadow.Size = UDim2.new(1, 28, 1, 28)
    shadow.BackgroundTransparency = 1
    shadow.Image = "rbxassetid://1316045217"
    shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
    shadow.ImageTransparency = 1 
    shadow.ZIndex = 0
    shadow.Parent = frame

    local glowLabel = Instance.new("TextLabel")
    glowLabel.Size = UDim2.new(1, -20, 1, 0)
    glowLabel.Position = UDim2.new(0, 10, 0, 0)
    glowLabel.BackgroundTransparency = 1
    glowLabel.Text = text
    glowLabel.Font = Enum.Font.GothamSemibold
    glowLabel.TextSize = 16
    glowLabel.TextWrapped = true
    glowLabel.TextColor3 = Color3.fromRGB(0, 170, 255)
    glowLabel.TextTransparency = 1 
    glowLabel.ZIndex = 1
    glowLabel.Parent = frame

    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, -20, 1, 0)
    label.Position = UDim2.new(0, 10, 0, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.GothamSemibold
    label.TextSize = 16
    label.TextWrapped = true
    label.Text = text
    label.TextTransparency = 1 
    label.ZIndex = 2
    label.Parent = frame

    local textStroke = Instance.new("UIStroke")
    textStroke.Thickness = 1
    textStroke.Color = Color3.fromRGB(0, 170, 255)
    textStroke.Transparency = 0.6
    textStroke.Parent = label

    local targetPos = UDim2.new(1, -220, 1, -80) 
    local outPos = UDim2.new(1, 20, 1, -80)    

    local tweenInFrame = TweenService:Create(frame, TweenInfo.new(0.28, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), { Position = targetPos })
    local tweenGlowIn = TweenService:Create(glowLabel, TweenInfo.new(0.28), { TextTransparency = 0.75 })
    local tweenLabelIn = TweenService:Create(label, TweenInfo.new(0.28), { TextTransparency = 0 })
    local tweenShadowIn = TweenService:Create(shadow, TweenInfo.new(0.28), { ImageTransparency = 0.7 })

    tweenInFrame:Play()
    tweenGlowIn:Play()
    tweenLabelIn:Play()
    tweenShadowIn:Play()

    task.delay(duration, function()
        local tweenOutFrame = TweenService:Create(frame, TweenInfo.new(0.28, Enum.EasingStyle.Quad, Enum.EasingDirection.In), { Position = outPos })
        local tweenGlowOut = TweenService:Create(glowLabel, TweenInfo.new(0.2), { TextTransparency = 1 })
        local tweenLabelOut = TweenService:Create(label, TweenInfo.new(0.2), { TextTransparency = 1 })
        local tweenShadowOut = TweenService:Create(shadow, TweenInfo.new(0.2), { ImageTransparency = 1 })

        tweenOutFrame:Play()
        tweenGlowOut:Play()
        tweenLabelOut:Play()
        tweenShadowOut:Play()

        tweenOutFrame.Completed:Wait()
        screenGui:Destroy()
    end)
end

return MessageModule
